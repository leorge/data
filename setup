myName=`basename $0`
# Try "bash setup" and "bash ./setup" for the following line.
# echo -n $myName; [ $0 = $myName ] && echo "" || echo " in $0"
REPO=data; INSTALLER=inst_cmd; BIN=~/bin; TMP=/tmp; NULL=/dev/null
if [ ! -x $BIN/$INSTALLER ]; then
    echo "Please download my scripts."
	echo "Visit https://github.com/leorge/scripts and read the README.md below in the page."
elif ! which $INSTALLER > $NULL; then	# ~/bin is absent in $PATH
	echo "Please logout and login again."
elif [ -d .git ]; then  # in a git repository
    repository=`grep "url = " .git/config | sed 's#.*/\(.*\)\.git#\1#'`
    if [ $repository = $REPO ]; then
        $INSTALLER git && echo -n "Pulling the repository... " && git pull
        addpath $PWD
    else
        echo This repository \"$repository\" is wrong.
		exit 1
    fi
elif [ -d $REPO ]; then # Scripts are in the sub-directory.
    pushd $REPO && bash $myName && popd && rm $0
elif $INSTALLER git; then   # not in a repository
    git clone https://github.com/leorge/$REPO.git && \
    addpath $PWD/$REPO && rm $0
elif $INSTALLER unzip; then # unzip(1) is available
    ZIP=master.zip
    wget -N https://github.com/leorge/$REPO/archive/$ZIP && \
    addpath $PWD/$REPO && rm $0
else
    ERR=$?
    echo "You can not install both git and unzip." >&2
    echo "Please clone the repository \"$REPO\" under another operating system, then retry." >&2
    exit $ERR
fi
