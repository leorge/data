myName=`basename $0`; myDir=`dirname $0`; SETUP=setup
echo \$0=$0 myDir=\"$myDir\" myName=\"$myName\"
REPO=data; INSTALLER=inst_cmd; BIN=~/bin; NULL=/dev/null
if ! which $INSTALLER > $NULL; then     # The installer is not available.
    echo "Please setup scripts first." >& 2
    echo "Visit https://github.com/leorge/scripts and read the guidance below in the page." >& 2
elif [ -d $myDir/.git ]; then  # in a git repository
    repository=`grep "url = " $myDir/.git/config | sed 's#.*/\(.*\)\.git#\1#'`
    if [ $repository != $REPO ]; then
        echo This repository \"$repository\" is not \"$REPO\".
    else
        $INSTALLER git && git pull
        echo addpath `echo $myDir | sed -e "s/^.$/$PWD/" -e "s#./#$PWD/#"`
    fi
elif [ -d $myDir/$REPO ]; then  # data generators maybe in the sub-directory.
    bash $myDir/$REPO/$SETUP && rm -f $0
else    # get the repository
    if ! $INSTALLER git; then   # not in a repository
        ERR=$?
        echo "You can not install git." >&2
        echo "Please clone the repository \"$REPO\" under another operating system, then retry." >&2
        exit $ERR
    elif git clone https://github.com/leorge/$REPO.git; then
        addpath $PWD/$REPO && rm -f $0
    fi
fi
